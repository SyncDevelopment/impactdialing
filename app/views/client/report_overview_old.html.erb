<%= render :partial => 'shared/boxtop', :locals=>{:title=>"#{@campaign.name} Answered Calls Report"} %>

<% @json_fields.each do |f| %>
	<% num=f[f.length-1,1] %>
	<% if f.index("result") %>
		<% this_result_set = JSON.parse(eval("@script.result_set_#{num}" )) %>
		<% name = this_result_set["name"] %>
		<% if name.blank? %>
			<h3><%=f%></h3>
		<% else %>
			<h3><%=name%></h3>
		<% end %>
	<% else %>
		<h3><%= f %></h3>
	<% end %>


	

   <table width="100%" border="0" cellspacing="0" cellpadding="0">
     <tr>
       <th>Answer</th>
       <th>Number</th>
       <th>Percentage</th>
     </tr>

	<% cnt=0 %>
	<% @results_hash[f].keys.each do |r| %>
		<% cnt+=@results_hash[f][r] %>
	<% end %>
	<% @results_hash[f].keys.each do |r| %>
		<% this_num=@results_hash[f][r].to_i %>
		<tr class="<%= cycle("odd","even") %>">
			<td><%= r %></td>
			<td><%= this_num %></td>
			<td><%=((this_num.to_f/cnt.to_f) *100).round%>
			<%# ((r[0].to_f/@total)*100).to_i %>%</td>
		</tr>
	<% end %>
	</table>
<% end %>
<br/>
	<% if @totalvoters>0 %>
	    <table width="100%" border="0" cellspacing="0" cellpadding="0">
	      <tr>
	        <th>Type</th>
	        <th>Numbers</th>
	        <th>Percentage</th>
	      </tr>

			<tr class="odd">
				<td>Remaining Numbers</td>
				<td><%= @voters_to_call.length %></td>
				<td><%=@voters_to_call.length/@totalvoters*100  %></td>
			</tr>
			<tr class="event">
				<td>Finished Numbers</td>
				<td><%= @voters_called.length %></td>
				<td><%=@voters_called.length/@totalvoters*100  %>%</td>
			</tr>
	    </table>
	<% end %>
	<div class="box-content">
	Report Date Range:
	<% form_tag ("/client/report_overview_old?id=#{ params[:id]}&type=#{params[:type]}") do %> 
	  
	<table>
		<tr>
			<td>From:</td>
			<td> <%= unobtrusive_date_text_picker_tag :from_date,@from_date %> </td>
		</tr>
		<tr>
			<td>
				To:</td>
			<td>  <%= unobtrusive_date_text_picker_tag :to_date,@to_date %> 
				<input type="submit" class="button" value="update" size="4">
				</td>
		</tr>
	</table>
	<% end %>
	
