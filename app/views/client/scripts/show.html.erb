<%= javascript_include_tag :cocoon %>
<%= javascript_include_tag "orderable" %>
<%= javascript_include_tag "client/scripts" %>

<h1>Edit script</h1>

<% if @script.errors.any? %>
  <div class = 'callout alert clearfix'>
    <%= error_messages_for :script %>
  </div>
<% end %>
<input id="script_id" type="hidden" value="<%= @script.id %>"/>

<%= semantic_form_for [:client, @script] do |form| %>
  <%= render "script_name", f: form %>
  <%= render "script_voter_fields", f: form, voter_fields: @voter_fields, voter_field_values: @voter_field_values %>  
  <%= render "script_call_results", f: form %>  
  
  <div class= "buttons">
  	<input type="checkbox" id="save_as" name="save_as" style="display:none">
    <button id= "script_submit" type="submit">Save</button>
  	<% unless @script.name.blank? %>
  		<button onclick="document.getElementById('save_as').checked = true;">Save as</button>
  	<% end %>
  </div>

<% end %>
<% content_for :javascripts do %>
  <script type ="text/javascript">
    $(document).ready(function() {
      script = new Scripts();
      script.set_question_order();
      script.set_possible_response_order();
      script.mark_answered(); 
      $('.orderable_element').sortElements(function(a, b){
          return $(a).find('.script_element').val() > $(b).find('.script_element').val() ? 1 : -1;
      });     
    });
    
  </script>
<% end %>

