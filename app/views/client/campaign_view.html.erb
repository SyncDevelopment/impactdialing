
<div id="callerid"></div>
<% form_for :campaign, :url => { :action => "campaign_add" , :id=>@campaign.id}, :html => {:name => 'callerForm', :id => 'callerForm'}   do |f| %>
<div id="content" style="width:100%;">


	<table width="100%" style="padding:10px;"> 
		<tr>
			<td valign="top" width="32%">

				<!--<div id="sidebar" style="width:250; margin-top:2px; margin-right:6px;">-->

					<!-- Box -->
					<div class="box">
					  <!-- Box Head -->
					  <div class="box-head">
					    <h2>Campaign Info</h2>
					  </div>
					  <!-- End Box Head-->
					  	<div class="box-content"> 
					        <label>Name:</label><br/>
							<%= f.text_field :name, {:class=>"field size3"} %>
							<br/>
							<br/>

					        <label>Caller ID:</label><br/>
							<%= f.text_field :caller_id, {:class=>"field size3"} %>
							<br/>
							<br/>
							Call-in number:
							<br/><div style="font-size:18px; padding-top:6px; "> <%= number_to_phone(APP_NUMBER, :area_code => true) %></div>
							<br/>
							Campaign ID:
							<br/><div style="font-size:18px; padding-top:6px; "> <%= @campaign.group_id %></div>
							<br/>

								Results:
								<br/><div style="font-size:18px; padding-top:6px; ">


								<%= f.collection_select(:script_id, Script.find_all_by_user_id_and_active(@user.id,1), :id, :name, { :prompt => true},  {:class=>"field"} 
					)  %>
							</div>

						</div>
					</div>
					<!-- End Box -->
				    <!-- End Sidebar -->
				    <div class="cl">&nbsp;</div>



				<!--</div>-->

			</td>
			<td> &nbsp; </td>
			<td width="32%" valign="top">
				<div class="box">
					<%= render :partial => 'boxtop', :locals=>{:title=>"Available Lists"} %>
					<% if @lists.length==0 %>
						<div class="form">
				      		<label>No lists entered.</label>
						</div>
			  			<div class="box-content"> 
							<a href="/client/voter_upload/<%= @campaign.id %>" class="add-button"><span>Upload Voters</span></a>
							<div class="cl">&nbsp;</div><br/>
							<% if @show_voter_buttons %>
							<a href="/client/voter_add?campaign_id=<%= @campaign.id %>" class="add-button"><span>Enter Voter</span></a>
							<div class="cl">&nbsp;</div><br/>
							<% end %>
						</div>
					<% else %>
			  			<div class="box-content" style="float:right;"> 
							<a href="/client/voter_upload/<%= @campaign.id %>" class="add-button"><span>Upload Voters</span></a>
							<div class="cl">&nbsp;</div><br/>
							<% if @show_voter_buttons %>
							<a href="/client/voter_add?campaign_id=<%= @campaign.id %>" class="add-button"><span>Enter Voter</span></a>
							<div class="cl">&nbsp;</div><br/>
							<a href="/client/voter_view?campaign_id=<%= @campaign.id %>" class="button"><span>View Voters</span></a>
							<div class="cl">&nbsp;</div>
							<% end %>
						</div>
				  		<div class="box-content">
							<div class="table2">
								<table border="0" cellspacing="0" cellpadding="0">
									<tr>
										<th>&nbsp;</th>
										<th>Name</th>
									</tr>
				    				<% @lists.each do |l| %>
										<tr>
											<td><%= check_box_tag "voter_list_ids[]", "#{l.id}", l.enabled -%></td>
											<td><%= l.name %></td>
										</t>
									<% end %>
								</table>
								<input type="hidden" name="listsSent" value="1">
								<% if @show_voter_buttons %><br/><br/><% end %>
								(uncheck to stop calling)<br/><br/>
							</div>
						</div>
					<% end %>
			  	</div>
			</td>
			<td> &nbsp; </td>
			<td width="32%" valign="top">
				<div class="box">
					<%= render :partial => 'boxtop', :locals=>{:title=>"Callers With Access"} %>
					<% if @callers.length==0 %>
						<div class="form">
					      <label>No callers entered.</label>
						</div>
				  		<div class="box-content"> 
							<a href="/client/callers" class="add-button"><span>Add callers</span></a>
							<div class="cl">&nbsp;</div>
						</div>
					<% else %>
					<!--
				  		<div class="box-content" style="float:right;"> 
							<a href="/client/caller_add" class="add-button"><span>Add Caller</span></a>
							<div class="cl">&nbsp;</div><br/>
						</div>
					-->
					  	<div class="table2">
									    <table width="100%" border="0" cellspacing="0" cellpadding="0">
								<tr>
									<th>Name</th>
									<th>&nbsp;</th>
									<th>PIN</th>
								</tr>
								<tr>
									<td><input type="checkbox" value="0" id="listUse" onclick="allCallers();"> All Callers</td>
									<td></td>
									<td></td>
								</tr>
				    			<% @callers.each do |l| %>
									<tr>
										<td><%= check_box_tag "campaign[caller_ids][]", "#{l.id}", callerInCampaign(l), :onclick=>"someCallers();" -%> <%= l.name %></td>
										<td></td>
										<td><%= l.pin %></td>
									</tr>
						<% end %>
						</table>
						<br/>
					  </div>
					  <!-- Table -->
					<% end %>
				</div>
			</td>
		</tr>
	</table>


</div>
<%# float_sidebar %>

<script>
function allCallers() {
	var f = document.forms['callerForm'].elements['campaign[caller_ids][]'];

	for(var i = 0; i < f.length; i++){
		f[i].checked = true;
	}

}
function someCallers() {
	$('listUse').checked=false;
	isAll();
}

function isAll(){
	var f = document.forms['callerForm'].elements['campaign[caller_ids][]'];
	var n=0;
	for(var i = 0; i < f.length; i++){
		if (f[i].checked == true)
		n++;
	}
	if (n==<%= @callers.length %>){
		$('listUse').checked=true;

		}
}
<% if @callers.length!=0 %>
isAll();
<% end %>
<%= remote_function(:update => "callerid",
      :url => { :action => "campaign_caller_id_verified", :id=>@campaign.id }) %>

</script>

<% end %>
<div>&nbsp;</div>



